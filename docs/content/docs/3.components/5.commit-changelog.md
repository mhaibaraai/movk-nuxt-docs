---
title: CommitChangelog
description: 了解如何使用 `CommitChangelog` 组件为您的组件或文件自动生成 Git 提交历史记录，实时展示最近的代码变更和改进。
category: components
links:
  - label: GitHub
    icon: i-simple-icons-github
    to: https://github.com/mhaibaraai/movk-nuxt-docs/blob/main/layer/app/components/content/CommitChangelog.vue
---

## 用法

`CommitChangelog` 组件会根据指定的文件路径，从 GitHub 仓库获取该文件的提交历史，并以时间线形式展示。

### 基本用法

在您的 Markdown 文档中使用以下语法：

```mdc[md]
:commit-changelog
```

组件会自动根据当前页面路由推断组件名称，并获取对应文件的提交历史。

### 指定组件名称

```mdc[md]
:commit-changelog{name="Button"}
```

### 自定义文件路径

如果您的文件不在默认的 `src` 目录，可以自定义路径：

```mdc[md]
:commit-changelog{commitPath="packages/ui/src" name="Button"}
```

### 完整配置示例

```mdc[md]
::commit-changelog
---
commitPath: 'packages/core/src'
prefix: 'components'
suffix: 'ts'
name: 'useUser'
---
```

这将查找 `packages/core/src/components/useUser.ts` 文件的提交历史。

## 工作原理

1. **路径推断**: 组件会根据 `name` 属性或当前路由名称推断文件名
2. **命名转换**:
   - Vue 组件（`.vue` 后缀）：使用 PascalCase 命名（如 `ButtonGroup` → `ButtonGroup.vue`）
   - 其他文件：使用 camelCase 命名（如 `use-user` → `useUser.ts`）
3. **获取提交**: 调用 GitHub API 获取指定文件的提交历史
4. **格式化显示**: 将提交信息格式化为易读的 Markdown，包含：
   - 提交 SHA（前 5 位）和链接
   - 提交信息（移除范围标注）
   - Issue 引用链接（如 `#123`）
   - 内联代码高亮

## 前置要求

使用此组件需要：

1. **GitHub 配置**: 在 `app.config.ts` 中配置 GitHub 相关信息（`url`、`branch`、`commitPath` 等）。详见 [GitHub 集成配置](/docs/getting-started/configuration#github-集成)。

2. **环境变量**: 需要在 `.env` 文件中配置 GitHub Personal Access Token：

```bash
NUXT_GITHUB_TOKEN=ghp_your_personal_access_token_here
```

::warning{to='https://github.com/settings/tokens'}
GitHub Token 需要具有读取仓库提交历史的权限（`repo` 或 `public_repo` scope）。您可以在 GitHub Settings > Developer settings > Personal access tokens 创建新的 token。
::

::tip
如果未配置 `NUXT_GITHUB_TOKEN`，组件将不会报错，而是显示 "No recent changes"。
::

::tip{title="性能优化建议"}
设置 `per_page: 100` 可以显著提升获取速度，减少 API 调用次数。API 会自动分页获取所有数据，不会丢失任何提交记录。
::

::warning{title="时间范围限制"}
`since` 和 `until` 参数的时间戳必须在 1970-01-01 到 2099-12-31 之间，否则可能返回异常结果。
::

## API

### Props

:component-props

## 示例

### 显示 Vue 组件的提交历史

```mdc[md]
:commit-changelog{name="Accordion"}
```

输出示例：
- [`a1b2c`](https://github.com/.../commit/a1b2c3) — fix: 修复折叠动画延迟问题 [#45](https://github.com/.../issues/45)
- [`d4e5f`](https://github.com/.../commit/d4e5f6) — feat: 添加 `disabled` 属性支持

### 显示 TypeScript 文件的提交历史

```mdc[md]
:commit-changelog{suffix="ts" name="useColorMode"}
```

### 按作者过滤提交

通过在 URL 查询参数中添加 `author` 可以只显示特定作者的提交：

```mdc[md]
:commit-changelog{author="user@example.com"}
```

::tip
`author` 参数可以是 GitHub 用户名或邮箱地址。例如：`?author=octocat` 或 `?author=user@example.com`
::

### 完整示例：自定义路径和后缀

```mdc[md]
:commit-changelog{commitPath="packages/core/src" prefix="utils" suffix="ts" name="formatter" author="user@example.com"}
```

这将查找 `packages/core/src/utils/formatter.ts?author=user@example.com` 的提交历史。

## Changelog

:commit-changelog
